<!-- ==== product.html (revised) ==== -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1"/>
  <title>Product â€” Resin Keycap Studio</title>
  <meta name="description" content="Artisan resin keycap. Cherry MX compatible. Handmade in Vietnam."/>

  <style>
    :root{
      --bg:#0a0f18; --fg:#e6edf6; --muted:#8fa0b6;
      --line:#1b273a; --surface:#101827; --surface-2:#0b1320;
      --brand:#0ea5e9; --brand-600:#0284c7; --ok:#22c55e;
      --radius:18px; --container:1200px; --gutter: clamp(18px, 6vw, 120px);
      --shadow: 0 20px 60px rgba(0,0,0,.45);
      --headerH:72px;
    }
    *{box-sizing:border-box}
    html{scroll-behavior:smooth}
    body{margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
    a{color:inherit;text-decoration:none}
    img{display:block;max-width:100%}
    .container{width:min(var(--container),92%);margin-inline:auto}
    section[id]{scroll-margin-top:calc(var(--headerH) + 12px)}

    /* Header */
    .header{position:sticky;top:0;z-index:50;background:rgba(10,15,24,.72);backdrop-filter:blur(8px);border-bottom:1px solid var(--line)}
    .nav{min-height:72px;display:flex;align-items:center;justify-content:space-between;padding-inline:var(--gutter);gap:16px}
    .brand{display:flex;align-items:center;gap:12px;font-weight:900}
    .brand img{width:44px;height:44px;border-radius:12px}
    .navlinks{display:flex;gap:28px}
    .navlinks a{opacity:.92;padding:8px 10px;border-radius:10px}
    .navlinks a:hover{background:#0f1726}
    .icons{display:flex;gap:10px;align-items:center}
    .icon-btn{width:44px;height:44px;display:grid;place-items:center;border-radius:12px;border:1px solid var(--line);background:transparent;cursor:pointer}
    .cart-count{position:absolute;top:-6px;right:-6px;background:#16a34a;color:#02110f;font-weight:800;border-radius:999px;padding:2px 6px;font-size:12px;line-height:1}

    /* Sections */
    .section{padding:40px var(--gutter)}

    /* Product hero */
    .product-wrap{display:grid;grid-template-columns:1.05fr .95fr;gap:32px;align-items:start}
    @media (max-width:980px){ .product-wrap{grid-template-columns:1fr} }

    .gallery{position:relative}
    .main-img{aspect-ratio:4/3;object-fit:cover;border:1px solid var(--line);border-radius:14px;background:#0c1423}
    .thumbs{margin-top:12px;display:flex;gap:10px;flex-wrap:wrap}
    .thumb{width:78px;height:78px;border:1px solid var(--line);border-radius:10px;overflow:hidden;cursor:pointer;opacity:.8}
    .thumb.active,.thumb:hover{opacity:1;border-color:#2c9eea}
    .g-arrow{position:absolute;top:50%;transform:translateY(-50%);width:42px;height:42px;border-radius:999px;border:1px solid var(--line);background:#0c1423aa;display:grid;place-items:center;cursor:pointer}
    .g-arrow:hover{background:#0c1423}
    .g-prev{left:10px}.g-next{right:10px}

    .title{font-size:clamp(26px,3.2vw,36px);margin:0 0 6px;font-weight:900}
    .muted{color:var(--muted)}
    .price{font-weight:900;font-size:22px;margin:16px 0}
    .btn{display:inline-flex;align-items:center;gap:10px;padding:12px 18px;border-radius:12px;border:1px solid var(--line);cursor:pointer;background:transparent;color:inherit}
    .btn--brand{background:var(--brand);color:#06121b;border:none}
    .btn--brand:hover{background:var(--brand-600);color:#fff}
    .mini{display:flex;align-items:center;gap:10px;flex-wrap:wrap}

    /* Quantity control */
    .qty{
      display:inline-flex;align-items:center;
      border:1px solid var(--line);border-radius:12px;overflow:hidden;
      margin-right:10px;height:44px;background:#0c1423;
    }
    .qty input{
      width:56px;background:transparent;border:0;text-align:center;
      color:var(--fg);height:100%;font-weight:700;font-size:16px;
      -moz-appearance:textfield;
    }
    .qty input::-webkit-outer-spin-button,.qty input::-webkit-inner-spin-button{ -webkit-appearance:none;margin:0 }
    .qbtn{width:44px;height:44px;background:transparent;border:0;color:var(--fg);cursor:pointer;font-size:18px;display:grid;place-items:center}
    .qbtn:hover{background:#0f1726}

    /* Highlights 2 cá»™t (plain) */
    .highlights{padding:10px 0 0}
    .highlights h3{margin:18px 0 10px}
    .hl-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px 26px}
    .hl-grid li{list-style:disc;margin-left:18px;color:var(--fg)}
    @media (max-width:800px){ .hl-grid{grid-template-columns:1fr} }

    /* Item detail (plain) */
    .detail{padding-top:14px}
    .detail h3{margin:24px 0 10px}
    .detail p{margin:0 0 12px}
    .detail b{color:#dbe9ff}

    /* Shipping full width */
    #ship.section{padding-top:22px}
    .ship-wrap{width:100%;max-width:none;margin:0;padding:0 var(--gutter)}
    .ship h3{margin:0 0 10px}
    .ship ul{margin:8px 0 0 18px}
    .ship li{margin:8px 0;color:var(--fg)}

    /* Related */
    .related{padding-top:28px}
    .grid{display:grid;gap:18px}
    .grid.products{grid-template-columns:repeat(3,1fr)}
    @media (max-width:1024px){ .grid.products{grid-template-columns:repeat(2,1fr)} }
    @media (max-width:640px){ .grid.products{grid-template-columns:1fr} }
    .card{border:1px solid var(--line);border-radius:14px;overflow:hidden;background:#0c1423}
    .card img{aspect-ratio:4/3;object-fit:cover}
    .card .body{padding:12px 14px}
    .card h4{margin:0 0 6px}

    /* Contact 2 cá»™t */
    .contact h3{margin:0 0 8px}
    .contact .lead{margin:0 0 14px;color:var(--muted)}
    .contact-grid{display:grid;grid-template-columns:1fr 1fr;gap:18px}
    .contact-grid p{margin:0 0 8px}
    @media (max-width:800px){ .contact-grid{grid-template-columns:1fr} }

    /* Cart Drawer (giá»‘ng index) */
    .drawer{
      position:fixed;right:0;top:0;height:100dvh;width:min(440px,92%);background:#0c1423;border-left:1px solid var(--line);
      transform:translateX(100%);transition:.3s;z-index:60;box-shadow:-30px 0 60px rgba(0,0,0,.4);display:flex;flex-direction:column
    }
    .drawer.open{transform:none}
    .drawer__head{padding:18px 16px;border-bottom:1px solid var(--line);display:flex;justify-content:space-between;align-items:center}
    .drawer__body{padding:14px 16px;overflow:auto;flex:1;display:flex;flex-direction:column;gap:12px}
    .cart-item{display:grid;grid-template-columns:64px 1fr auto;gap:12px;align-items:center;border:1px solid var(--line);border-radius:12px;padding:10px;background:#0e1728}
    .cart-item img{width:64px;height:64px;object-fit:cover;border-radius:8px}
    .cart-item b{display:block}
    .cart-item small{color:var(--muted)}
    .cart-item .rm{border:none;background:transparent;color:#ffb4b4;cursor:pointer}
    .drawer__foot{border-top:1px solid var(--line);padding:14px 16px}
    .total-row{display:flex;justify-content:space-between;font-weight:900;margin-bottom:10px}
  </style>
</head>
<body>

  <!-- Header -->
  <header class="header">
    <div class="nav">
      <a class="brand" href="index.html#home">
        <img src="/images/logo-k-resin.png" alt="Logo">
        <span>Resin Keycap Studio</span>
      </a>
      <nav class="navlinks">
        <a href="index.html#home">Home</a>
        <a href="index.html#collections">Collections</a>
        <a href="#ship">Shipping & Return</a>
        <a href="#contact">Contact</a>
      </nav>
      <div class="icons">
        <div style="position:relative">
          <button class="icon-btn" id="openCart" title="Cart">ðŸ›’</button>
          <span class="cart-count" id="count">0</span>
        </div>
      </div>
    </div>
  </header>

  <!-- Product -->
  <section class="section">
    <div class="container product-wrap">
      <!-- Gallery -->
      <div class="gallery">
        <button class="g-arrow g-prev" id="prev" aria-label="Previous">â€¹</button>
        <img id="main" class="main-img" src="" alt="">
        <button class="g-arrow g-next" id="next" aria-label="Next">â€º</button>

        <div class="thumbs" id="thumbs"></div>

        <!-- Highlights -->
        <div class="highlights">
          <h3>Highlights</h3>
          <ul class="hl-grid" id="hlList"></ul>
        </div>
      </div>

      <!-- Info -->
      <div>
        <h1 class="title" id="pName"></h1>
        <p class="muted" id="pDesc"></p>
        <div class="price" id="pPrice"></div>

        <div class="mini">
          <!-- Quantity -->
          <div class="qty">
            <button type="button" class="qbtn" id="qMinus">âˆ’</button>
            <input id="qty" type="number" min="1" value="1" inputmode="numeric" />
            <button type="button" class="qbtn" id="qPlus">+</button>
          </div>
          <!-- Add to Cart -->
          <button class="btn btn--brand" id="add">Add to Cart</button>
          <a class="btn" href="index.html#collections">Back to Collections</a>
        </div>

        <div class="detail" id="pDetail">
          <h3>Item Detail</h3>
          <!-- ná»™i dung sáº½ Ä‘á»• báº±ng JS -->
        </div>
      </div>
    </div>
  </section>

  <!-- Shipping & Return (full width) -->
  <section id="ship" class="section ship">
    <div class="ship-wrap">
      <h3>Shipping & Return</h3>
      <ul>
        <li>Processing time: 3â€“5 business days for inâ€‘stock items; 7â€“14 days for madeâ€‘toâ€‘order.</li>
        <li>Worldwide shipping with tracking. Delivery estimate 5â€“14 business days (destination dependent).</li>
        <li>Return/Exchange within 7 days on arrival for manufacturing defects (photos required).</li>
        <li>Handcrafted nature: each cap is unique â€” minor variations are part of the craft.</li>
      </ul>
    </div>
  </section>

  <!-- Related -->
  <section class="section related">
    <div class="container">
      <h3>You may also like</h3>
      <div class="grid products" id="relGrid"></div>
    </div>
  </section>

  <!-- Contact -->
  <footer id="contact" class="section contact" style="border-top:1px solid var(--line);padding-top:24px">
    <div class="container">
      <h3>Contact â€” We reply within 24 hours.</h3>
      <p class="lead">Weâ€™ll get back with a quote &amp; lead time.</p>

      <div class="contact-grid">
        <div>
          <p><b>Email:</b> <a class="muted" href="mailto:order@yourshop.vn">order@yourshop.vn</a></p>
          <p><b>Instagram:</b> <a class="muted" href="#" target="_blank">@resin.keycap.studio</a></p>
        </div>
        <div>
          <p><b>Zalo/Phone:</b> <span class="muted">+84 9xx xxx xxx</span></p>
          <p><b>Facebook:</b> <a class="muted" href="#" target="_blank">Resin Keycap Studio</a></p>
        </div>
      </div>

      <p class="muted" style="margin-top:10px">Saigon â€” visit by appointment Â· Monâ€“Sat, 9:00â€“18:00 (GMT+7)</p>

      <div style="margin-top:12px;display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;border-top:1px solid var(--line);padding-top:16px">
        <small>Â© <span id="y"></span> Resin Keycap Studio</small>
        <div class="muted">Terms Â· Privacy</div>
      </div>
    </div>
  </footer>

  <!-- Cart Drawer -->
  <aside class="drawer" id="cartDrawer" aria-label="Cart">
    <div class="drawer__head">
      <b>Your Cart</b>
      <button class="btn" id="closeCart">Close</button>
    </div>
    <div class="drawer__body" id="cartItems"></div>
    <div class="drawer__foot">
      <div class="total-row"><span>Total</span><span id="cartTotal">$0.00</span></div>
      <button class="btn btn--brand" style="width:100%">Checkout</button>
    </div>
  </aside>

  <script>
    // ===== Year
    document.getElementById('y').textContent = new Date().getFullYear();

    // ===== Data for all products (c1..c10) =====
    const DB = {
      c2: {
        name:'Forest Mist', price:45,
        main:'/images/c2.jpg',
        gallery:['/images/c2.jpg','/images/c2.1.jpg','/images/c2.2.jpg','/images/c2.3.jpg','/images/c2.4.jpg','/images/c2.5.jpg'],
        desc:'Crystalâ€‘clear resin with deep green accents â€” tranquil woods. Cherry MX compatible.',
        highlights:['Handmade in Vietnam','Ecoâ€‘friendly resin','Ships worldwide','MX compatible'],
        detailHTML: `
          <p>Enhance your keyboard with the <b>Poke Monster Resin Keycap</b>, an animeâ€‘inspired, handmade accessory perfect for gaming enthusiasts. This artisan keycap adds a unique and playful touch to your mechanical keyboard and fits Cherry MX / MX Style switches.</p>
          <p><b>Animeâ€‘Inspired Design:</b> brings a fun and nostalgic vibe to your keyboard.</p>
          <p><b>Handcrafted Quality:</b> highâ€‘quality resin with a glossy, eyeâ€‘catching finish.</p>
          <p><b>Perfect for Gamers:</b> comfortable typing & gaming experience.</p>
          <p><b>Compatible & Easy to Install:</b> Cherry MX / MX Style.</p>
          <p><b>Great Gift:</b> for gamers, anime lovers & keyboard enthusiasts.</p>
  
    };

    // ===== Read id from URL & fallback
    const params = new URLSearchParams(location.search);
    const pid = params.get('id') || 'c1';
    const P = DB[pid] || DB['c1'];

    // ===== Shortcuts
    const $ = sel => document.querySelector(sel);
    const main = $('#main');
    const thumbsWrap = $('#thumbs');
    const nameEl = $('#pName');
    const descEl = $('#pDesc');
    const priceEl = $('#pPrice');
    const hlList = $('#hlList');
    const detailEl = $('#pDetail');

    // ===== Fill product info
    nameEl.textContent = P.name;
    descEl.textContent = P.desc;
    priceEl.textContent = `$${P.price.toFixed(2)}`;
    detailEl.insertAdjacentHTML('beforeend', P.detailHTML || '');

    // Thumbnails + main image
    function renderThumbs(){
      thumbsWrap.innerHTML = P.gallery.map((src,i)=>`
        <img class="thumb ${i===0?'active':''}" data-src="${src}" src="${src}" alt="">
      `).join('');
      main.src = P.gallery[0];
      main.alt = P.name;
    }
    renderThumbs();

    // Highlights
    hlList.innerHTML = (P.highlights||[]).map(h=>`<li>${h}</li>`).join('');

    // Gallery controls
    let idx = 0;
    function setActive(i){
      const thumbs = [...document.querySelectorAll('.thumb')];
      idx = (i + thumbs.length) % thumbs.length;
      thumbs.forEach((t,ti)=>t.classList.toggle('active', ti===idx));
      main.src = thumbs[idx].dataset.src;
    }
    thumbsWrap.addEventListener('click', e=>{
      const t = e.target.closest('.thumb'); if(!t) return;
      const thumbs = [...document.querySelectorAll('.thumb')];
      setActive(thumbs.indexOf(t));
    });
    $('#prev').addEventListener('click', ()=> setActive(idx-1));
    $('#next').addEventListener('click', ()=> setActive(idx+1));

    // ===== Cart (shared via localStorage)
    const CART_KEY = 'rks_cart_v1';
    const drawer = $('#cartDrawer');
    const cartItems = $('#cartItems');
    const cartTotal = $('#cartTotal');
    const countBadge = $('#count');

    function loadCart(){ try{ return JSON.parse(localStorage.getItem(CART_KEY))||[] }catch{ return [] } }
    function saveCart(c){ localStorage.setItem(CART_KEY, JSON.stringify(c)); }
    function cartCount(c){ return c.reduce((s,x)=>s+x.qty,0); }
    function cartSum(c){ return c.reduce((s,x)=>s+x.qty*x.price,0); }

    function renderCart(){
      const cart = loadCart();
      countBadge.textContent = cartCount(cart);
      if(!cart.length){
        cartItems.innerHTML = '<div class="muted">Your cart is empty.</div>';
        cartTotal.textContent = '$0.00';
        return;
      }
      cartItems.innerHTML = cart.map(it => `
        <div class="cart-item">
          <img src="${it.img}" alt="${it.name}">
          <div>
            <b>${it.name}</b>
            <small>$${it.price.toFixed(2)} Ã— ${it.qty}</small>
          </div>
          <button class="rm" onclick="removeFromCart('${it.id}')">âœ•</button>
        </div>
      `).join('');
      cartTotal.textContent = '$' + cartSum(cart).toFixed(2);
    }
    function addToCart(item){
      const cart = loadCart();
      const ex = cart.find(x=>x.id===item.id);
      if(ex) ex.qty += item.qty || 1;
      else cart.push({...item, qty:item.qty||1});
      saveCart(cart);
      renderCart();
      openCart();
    }
    function removeFromCart(id){
      const cart = loadCart().filter(x=>x.id!==id);
      saveCart(cart);
      renderCart();
    }
    window.removeFromCart = removeFromCart;

    function openCart(){ drawer.classList.add('open'); }
    function closeCart(){ drawer.classList.remove('open'); }
    $('#openCart').addEventListener('click', openCart);
    $('#closeCart').addEventListener('click', closeCart);
    document.addEventListener('keydown', e=>{ if(e.key==='Escape') closeCart(); });

    // Qty controls
    const qtyInput = document.getElementById('qty');
    document.getElementById('qPlus').addEventListener('click', ()=> { qtyInput.value = (+qtyInput.value||1)+1; });
    document.getElementById('qMinus').addEventListener('click', ()=> { qtyInput.value = Math.max(1,(+qtyInput.value||1)-1); });

    // Add to Cart (single handler)
    document.getElementById('add').addEventListener('click', ()=>{
      const qty = Math.max(1, parseInt(qtyInput.value||'1',10));
      const img = document.getElementById('main').getAttribute('src') || P.main;
      addToCart({ id: pid, name: P.name, price: P.price, img, qty });
    });

    // Initial
    renderCart();

    // Related (3 khÃ¡c sáº£n pháº©m hiá»‡n táº¡i)
    const relIds = Object.keys(DB).filter(k=>k!==pid).slice(0,3);
    const relGrid = document.getElementById('relGrid');
    relGrid.innerHTML = relIds.map(k=>{
      const r = DB[k];
      return `
        <a class="card" href="product.html?id=${k}">
          <img src="${r.main}" alt="${r.name}">
          <div class="body"><h4>${r.name}</h4><span class="muted">$${r.price.toFixed(2)}</span></div>
        </a>
      `;
    }).join('');
  </script>
</body>
</html>
